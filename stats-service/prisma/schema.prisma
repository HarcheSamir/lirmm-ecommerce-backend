generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model DailyAggregate {
  date                DateTime @id @db.Date
  totalRevenue        Decimal  @default(0) @db.Decimal(12, 2)
  ordersCount         Int      @default(0)
  newCustomersCount   Int      @default(0)
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  @@map("daily_aggregates")
}

model FactOrder {
  id                  String   @id
  status              String
  totalAmount         Decimal  @db.Decimal(10, 2)
  countryCode         String?
  createdAt           DateTime
  itemCount           Int
  paymentMethod       String

  items FactOrderItem[]
  @@map("fact_orders")
}

model FactOrderItem {
  id            String @id
  orderId       String
  productId     String
  productName   String
  quantity      Int
  price         Decimal @db.Decimal(10, 2)
  lineItemTotal Decimal @db.Decimal(10, 2)

  order FactOrder @relation(fields: [orderId], references: [id], onDelete: Cascade)
  @@map("fact_order_items")
}